import sys
from optparse import OptionParser

from cdsagent import service as os_service
from cdsagent.main import AgentManager
from cdsagent import cfg


__author__ = 'Hardy.zheng'


parser = OptionParser()
parser.add_option("-c", "--config", dest="filename",
                  help="cds agent configure file",
                  metavar="FILE")


def run():
    os_service.launch(AgentManager()).wait()


if __name__ == '__main__':

    (options, args) = parser.parse_args()
    if not options.filename:
        parser.error("not input config file, --config filename")
    cfg._configure_file = options.filename
    run()
